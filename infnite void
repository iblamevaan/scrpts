--// Infinite Void | Keybind: V

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local Lighting = game:GetService("Lighting")
local Debris = game:GetService("Debris")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local cooldown = false
local COOLDOWN_TIME = 10

local function InfiniteVoid()
	if cooldown then return end
	cooldown = true

	local character = player.Character or player.CharacterAdded:Wait()
	local humanoid = character:WaitForChild("Humanoid")
	local hrp = character:WaitForChild("HumanoidRootPart")

	-- =====================
	-- START AUDIO
	-- =====================
	local startSound = Instance.new("Sound")
	startSound.SoundId = "rbxassetid://96616607755426"
	startSound.Volume = 3
	startSound.PlaybackSpeed = 1
	startSound.Parent = workspace
	startSound:Play()

	-- =====================
	-- FORCE / FREEZE EFFECT
	-- =====================
	local FREEZE_START_DISTANCE = 1000
	local WALL_DISTANCE = 1
	local PUSH_FORCE = 100000
	local PUSH_OUT_SPEED = 150
	local active = true

	local function getNearbyUnanchoredParts(centerPos, range)
		local region = Region3.new(
			centerPos - Vector3.new(range, range, range),
			centerPos + Vector3.new(range, range, range)
		)
		local parts = workspace:FindPartsInRegion3WithIgnoreList(region, {character}, math.huge)
		local valid = {}

		for _, part in ipairs(parts) do
			if part:IsA("BasePart") and not part.Anchored and not part:IsDescendantOf(character) then
				table.insert(valid, part)
			end
		end
		return valid
	end

	local heartbeatConn
	heartbeatConn = RunService.Heartbeat:Connect(function()
		if not active then return end
		if not hrp then return end

		for _, part in ipairs(getNearbyUnanchoredParts(hrp.Position, FREEZE_START_DISTANCE)) do
			local offset = part.Position - hrp.Position
			local distance = offset.Magnitude

			local bv = part:FindFirstChild("RepelForce")
			if not bv then
				bv = Instance.new("BodyVelocity")
				bv.Name = "RepelForce"
				bv.MaxForce = Vector3.new(PUSH_FORCE, PUSH_FORCE, PUSH_FORCE)
				bv.P = 4000000
				bv.Parent = part
			end

			if distance <= WALL_DISTANCE then
				bv.Velocity = offset.Unit * PUSH_OUT_SPEED
			else
				bv.Velocity = part.AssemblyLinearVelocity * 0
			end
		end
	end)

	-- =====================
	-- SKY + VOID EFFECT
	-- =====================
	local oldSky = Lighting:FindFirstChildOfClass("Sky")
	if oldSky then oldSky = oldSky:Clone() end
	for _, v in ipairs(Lighting:GetChildren()) do
		if v:IsA("Sky") then v:Destroy() end
	end

	local sky = Instance.new("Sky", Lighting)
	for _, f in ipairs({"Bk","Dn","Ft","Lf","Rt","Up"}) do
		sky["Skybox"..f] = "rbxassetid://6444320592"
	end

	local cc = Instance.new("ColorCorrectionEffect", Lighting)
	cc.TintColor = Color3.new(0,0,0)
	cc.Brightness = -1
	TweenService:Create(cc, TweenInfo.new(0.8), {
		TintColor = Color3.new(1,1,1),
		Brightness = 0
	}):Play()

	-- =====================
	-- XRAY WORLD
	-- =====================
	local hidden = {}
	for _, p in ipairs(workspace:GetDescendants()) do
		if p:IsA("BasePart") and p.Anchored then
			p.Transparency = 1
			p.CastShadow = false
			table.insert(hidden, p)
		end
	end

	-- =====================
	-- END AFTER DURATION
	-- =====================
	task.delay(9, function()
		active = false
		if heartbeatConn then heartbeatConn:Disconnect() end

		for _, p in ipairs(workspace:GetDescendants()) do
			if p:IsA("BodyVelocity") and p.Name == "RepelForce" then
				p:Destroy()
			end
		end

		for _, p in ipairs(hidden) do
			if p:IsA("BasePart") then
				p.Transparency = 0
				p.CastShadow = true
			end
		end

		sky:Destroy()
		cc:Destroy()
		if oldSky then oldSky.Parent = Lighting end
	end)

	-- =====================
	-- FINAL AUDIO
	-- =====================
	task.delay(8.5, function()
		local endSound = Instance.new("Sound")
		endSound.SoundId = "rbxassetid://7486846874"
		endSound.Volume = 3
		endSound.PlaybackSpeed = 1
		endSound.Parent = workspace
		endSound:Play()
	end)

	task.delay(COOLDOWN_TIME, function()
		cooldown = false
	end)
end

-- =====================
-- KEYBIND (V)
-- =====================
UserInputService.InputBegan:Connect(function(input, gpe)
	if gpe then return end
	if input.KeyCode == Enum.KeyCode.V then
		InfiniteVoid()
	end
end)
